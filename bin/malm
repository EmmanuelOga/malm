#!/usr/bin/env ruby
$LOAD_PATH.unshift(File.join(File.dirname(__FILE__), "..", "lib"))
require 'malm'
require 'clamp'

class MalmCommand < Clamp::Command
  option ["-l", "--log"], "FILE", "file to log mail messages to (optional)"

  option ["-p", "--smtpport"], "SMTP PORT", "SMTP port to listen on", :default => 2525 do |port|
    Integer(port)
  end
  
  option ["-w", "--webport"], "WEB PORT", "Port for client web app to view malmed messages", :default => 4567 do |port|
    Integer(port)
  end
  
  def execute
    malm = Malm.new(:log => log, :smtpport => smtpport, :webport => webport)
    malm.run!
  end
end
MalmCommand.run

